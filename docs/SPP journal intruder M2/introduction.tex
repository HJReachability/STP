% !TEX root = SPP_IoTjournal.tex
\section{Introduction \label{sec:introduction}}
Recently, there has been an immense surge of interest in the use of unmanned aerial systems (UASs) for civil applications. The applications include package delivery, aerial surveillance, disaster response, among many others \cite{Tice91, Debusk10, Amazon16, AUVSI16, BBC16}. These civil applications will involve unmanned aerial vehicles (UAVs) flying in urban environments, potentially in close proximity to humans, other UAVs, and other important assets. As a result, new scalable ways to organize an airspace are required in which potentially thousands of UAVs can fly together \cite{FAA13, Kopardekar16}.
%government agencies such as the Federal Aviation Administration (FAA) and National Aeronautics and Space Administration (NASA) of the United States are urgently trying to develop new scalable ways to organize an airspace in which potentially thousands of UAVs can fly together \cite{FAA13, Kopardekar16}.
One essential problem that needs to be addressed for this endeavor to be successful is that of trajectory planning: how a group of vehicles in the same vicinity can reach their destinations while avoiding situations which are considered dangerous, such as collisions. Many previous studies address this problem under different assumptions. In some studies, specific control strategies for the vehicles are assumed, and approaches such as those involving induced velocity obstacles \cite{Fiorini98, Chasparis05, Vandenberg08,Wu2012} and involving virtual potential fields to maintain collision avoidance \cite{Olfati-Saber2002, Chuang07} have been used. Methods have also been proposed for real-time trajectory generation \cite{Feng-LiLian2002}, for path planning for vehicles with linear dynamics in the presence of obstacles with known motion \cite{Ahmadzadeh2009}, and for cooperative path planning via waypoints which do not account for vehicle dynamics \cite{Bellingham}. Other related work is in the collision avoidance problem without path planning. These results include those that assume the system has a linear model \cite{Beard2003, Schouwenaars2004, Stipanovic2007}, rely on a linearization of the system model \cite{Massink2001, Althoff2011}, assume a simple positional state space \cite{Lin2015}, and many others \cite{Lalish2008, Hoffmann2008, Chen2016}.

However, to make sure that a dense group of UAVs can safely fly in close vicinity of each other, we need the capability to flexibly plan provably safe and dynamically feasible trajectories without making strong assumptions on the vehicles' dynamics and other vehicles' motion. Moreover, any trajectory planning scheme that addresses collision avoidance must also guarantee both goal satisfaction and safety of UAVs despite disturbances caused by wind and communication faults \cite{Kopardekar16}. Furthermore, unexpected scenarios such as UAV malfunctions or even UAVs with malicious intent need to be accounted for. Finally, the proposed scheme should scale well with the number of vehicles.

The problem of trajectory planning and collision avoidance under disturbances in safety-critical systems has been studied using Hamilton-Jacobi (HJ) reachability analysis, which provides guarantees on goal satisfaction and safety of optimal system trajectories \cite{Barron90, Mitchell05, Bokanowski10, Bokanowski11, Margellos11, Fisac15}. Reachability-based methods are particularly suitable in the context of UAVs because of the formal guarantees that are provided. In reachability analysis, one computes the reach-avoid set, defined as the set of states from which the system can be driven to a target set while satisfying time-varying state constraints at all times. A major practical appeal of this approach stems from the availability of modern numerical tools, which can compute various definitions of reachable sets \cite{Sethian96, Osher02, Mitchell02, Mitchell07b}. These numerical tools, for example, have been successfully used to solve a variety of differential games, trajectory planning problems, and optimal control problems \cite{Bayen07, Ding08, Bouffard12, Huang11}. 
%Concrete practical applications include aircraft auto-landing \cite{Bayen07}, automated aerial refueling \cite{Ding08}, safe control of quadrotors \cite{Bouffard12}, and multiplayer reach-avoid games \cite{Huang11}. 
Despite its power, the approach becomes numerically intractable as the state space dimension increases. In particular, reachable set computations involve solving a HJ partial differential equation (PDE) or variational inequality (VI) on a grid representing a discretization of the state space, resulting in an \textit{exponential} scaling of computational complexity with respect to the dimensionality of the problem. Therefore, as such, dynamic programming-based approaches such as reachability analysis are not suitable for managing the next generation airspace, which is a large-scale system with a high-dimensional joint state space because of the possible high density of vehicles that needs to be accommodated \cite{Kopardekar16}.  

To overcome this problem, the Sequential Trajectory Planning (STP) method has been proposed \cite{Chen15c, Bansal2017}. In this context, vehicles are assigned a strict priority ordering. Higher-priority vehicles plan their trajectories without taking into account the lower-priority vehicles, and lower-priority vehicles treat higher-priority vehicles as moving obstacles. Under this assumption, time-varying formulations of reachability \cite{Bokanowski11, Fisac15} can be used to obtain the optimal and provably safe trajectories for each vehicle, starting from the highest-priority vehicle. Thus, the curse of dimensionality is overcome for the multi-vehicle trajectory planning problem at the cost of a structural assumption, under which the computation complexity scales just \textit{linearly} with the number of vehicles. In addition, a structure like this has the potential to flexibly divide up the airspace for the use of many UAVs and allows tractable multi-vehicle trajectory-planning. Practically, different economic mechanisms can be used to establish a priority order. One example could be first-come-first-serve mechanism, as highlighted in NASA's concept of operations for UAS traffic management \cite{Kopardekar16}.

%The authors in \cite{Bansal2017} extend the STP method to the scenarios where disturbances, such as wind, are present in the system, resolving some of the practical challenges associated with the basic STP algorithm in \cite{Chen15c}. 
However, if a vehicle not in the set of STP vehicles enters the system, or even worse, if this vehicle has malicious intent, the original plan can lead to vehicles entering into another vehicle's danger zone. Thus, if vehicles do not plan with an additional safety margin that takes a potential intruder into account, a vehicle trying to avoid the intruder may effectively become an intruder itself, leading to a domino effect, causing the entire STP structure to collapse. 

The authors in \cite{chen2016robust} propose an STP algorithm that accounts for such a potential intruder. However, a new full-scale trajectory planning problem is required to be solved in real time to ensure safe transit of the vehicles to their respective destinations. Since the replanning must be done in real-time, the proposed algorithm is intractable for large-scale systems even with the STP structure, rendering the method unsuitable for practical implementation in these cases. In this work, we propose a novel intruder avoidance algorithm, which will need to replan trajectories only for a \textit{fixed number of vehicles}, irrespective of the total number of STP vehicles. Moreover, this number is a design parameter, which can be chosen beforehand based on the computational resources available for replanning during run time, thus overcoming the limitations of the algorithm in \cite{chen2016robust}. 

Intuitively, for every vehicle, we compute a \textit{separation region} such that the vehicle needs to account for the intruder if and only if the intruder is inside this separation region. We then compute a \textit{buffer region} between the separation regions of any two vehicles, and ensure that this buffer is maintained as vehicles are traveling to their destinations. Thus, to intrude with every additional vehicle, the intruder will have to travel through this buffer region. Consequently, we can affect this traveling time based on the size of the buffer region. Thus, for a given time duration, we can design the buffer region size such that the intruder can affect atmost a desirable number of vehicles within that duration. A high-level overview of the proposed algorithm is provided in Algorithm \ref{alg:basic_idea}.    
%
\begin{algorithm}[tb]
\SetKwInOut{Input}{input}
\SetKwInOut{Output}{output}
	\DontPrintSemicolon
	\caption{Overview of the proposed intruder avoidance algorithm (planning phase)}
	\label{alg:basic_idea}
	\Input{Set of vehicles $\veh_i, i = 1, \ldots, \N$ in the descending priority order;\newline
	Vehicle dynamics and initial states;\newline
	Vehicle destinations and any obstacles to avoid;\newline
	Intruder dynamics;\newline
	$\nva$: Maximum number of vehicles allowed to re-plan their trajectories.}
    \Output{Provably safe vehicle trajectories to respective destinations despite disturbance and intruder;\newline 
    Intruder avoidance and goal-satisfaction controller.}
	\For{\text{$i=1:N$}}{
			compute the separation region of $\veh_i$;\;
			compute the required buffer region based on $\nva$;\;
			use STP algorithm for trajectory planning of $\veh_i$ such that the buffer region is maintained between $\veh_i$ and $\veh_j$ for all $j<i$;\;
			output the trajectory and optimal controller for $\veh_i$.\;
		}
\end{algorithm}
%

The rest of the paper is organized as follows: in Section \ref{sec:formulation}, we formally present the STP problem in the presence of disturbances and adversarial intruders. In Section \ref{sec:background}, we present a brief review of time-varying reachability and the basic STP algorithms proposed in \cite{Chen15c}, \cite{Bansal2017}. In Section \ref{sec:intruder}, we explain the proposed algorithm to account for intruders. Finally, we illustrate this algorithm through a fifty-vehicle simulation in an urban environment in Section \ref{sec:simulations}. All running notations in this paper are summarized in Table \ref{table:notation}.